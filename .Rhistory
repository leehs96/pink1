library(DESeq2)
? dds
?? dds
setwd("C:/Users/LEE HAN SAI/Desktop/work/pink1")
setwd("C:/Users/LEE HAN SAI/Desktop/work/Pink1")
library(DESeq2)
library(ggrepel)
library(tximport)
library(RColorBrewer)
library(pheatmap)
#read files
files <- c("P2_rsem.genes.results",
"P4_rsem.genes.results",
"P6_rsem.genes.results",
"P8_rsem.genes.results",
"P9_rsem.genes.results",
"W5_rsem.genes.results",
"W6_rsem.genes.results",
"W7_rsem.genes.results",
"W8_rsem.genes.results",
"W9_rsem.genes.results")
#add names to list
names(files) <- c("P2","P4","P6","P8","P9","W5","W6","W7","W8","W9")
#tximport datafiles in directory
txData <- tximport(files,'rsem')
#change seqLen 0s to 1s
txData$length[txData$length == 0] <-1
#read column data
columns <- read.table("column.txt", header = T, sep = "\t" )
#data structure
dds <- DESeqDataSetFromTximport(txData, columns , ~Status)
#remove lowly exp. gene
keep <- rowSums(counts(dds)) >= 10
dds <- dds[keep,]
#export normalized exp values
ddsN <- estimateSizeFactors(dds)
ddsN <- estimateDispersions(ddsN)
Ndds <- counts(ddsN, normalized = T)
rlog(dds)
rlg <- rlog(dds)
View(rlg)
rld <- assay(rlog(dds, blind=FALSE))
View(rld)
write.csv(rld,"pink1_rlog.csv")
read.csv("pink1_rlog.csv",sep = ',', header = T, row.names = T)
read.csv("pink1_rlog.csv",sep = ',', header = T)
rlog <- read.csv("pink1_rlog.csv",sep = ',', header = T)
View(rlog)
df <- rlog[,-1]
View(df)
row.names(df) <- rlog[,1]
View(df)
med <- apply(df, 1, median)
med
head(med)
df - med
cmed <- df - med
View(cmed)
rlog <- read.csv("pink1_tds.csv",sep = ',', header = T)
df <- rlog[,-1]
row.names(df) <- rlog[,1]
med <- apply(df, 1, median)
cmed <- df - med
View(cmed)
med
med <- apply(df, 2, median)
cmed <- df - med
View(cmed)
med
# exp file
normExp <- read.csv("pink1_norm_rmDUP.csv", row.names = 1)
#DESeq
statsDE <- read.csv("ttest.csv", row.names = 1)
statsDE <- na.omit(statsDE)
statsDE <- statsDE[order(statsDE$padj),]
write.csv(statsDE,"ttest1.csv")
statsDE <- read.csv("ttest1.csv", row.names = 1)
statsDE$sig <- ifelse(statsDE$padj <= 0.05, "sig", "not")
#Volcano
statsDE$genelabels <- rownames(statsDE) %in% rownames(statsDE[1:10,])
#set threshold
padj.cutoff <- 0.05
lfc.cutoff <- 0.58
threshold <- statsDE$padj < padj.cutoff & abs(statsDE$log2FoldChange) > lfc.cutoff
length(which(threshold))
statsDE$threshold <- threshold
sigKO <- data.frame(subset(statsDE, threshold == TRUE & baseMean >= 100))
threshold1 <- file$padj < padj.cutoff & abs(file$log2FoldChange) > lfc.cutoff & file$baseMean >= 100
volcano <-
ggplot(statsDE, aes(x = log2FoldChange, y = -log10(padj), color = threshold)) +
geom_point() +
geom_text_repel(
colour = 'black',
size = 3,
aes(
x = log2FoldChange,
y = -log10(padj),
label = ifelse(genelabels == T, rownames(statsDE),""))
) +
ggtitle("Pink1 knock-out") +
xlab("Log2 fold change") +
ylab("-Log10 adjusted p-value") +
theme(
legend.position = "none",
plot.title = element_text(size = rel(1.5), hjust = 0.5),
axis.title = element_text(size = rel(1.25))
) +
scale_x_continuous()
volcano
volcano <-
ggplot(statsDE, aes(x = log2FoldChange, y = -log10(padj), color = threshold)) +
geom_point() +
geom_text_repel(
colour = 'black',
size = 3,
aes(
x = log2FoldChange,
y = -log10(padj),
label = ifelse(genelabels == T, rownames(statsDE),""))
) +
ggtitle("Pink1 knock-out") +
xlab("Log2 fold change") +
ylab("-Log10 adjusted p-value") +
theme(
legend.position = "none",
plot.title = element_text(size = rel(1.5), hjust = 0.5),
axis.title = element_text(size = rel(1.25))
) +
scale_x_continuous(limits=c(-12,12), breaks=seq(-12,12,2))
volcano
volcano <-
ggplot(statsDE, aes(x = log2FoldChange, y = -log10(padj), color = threshold)) +
geom_point() +
geom_text_repel(
colour = 'black',
size = 3,
aes(
x = log2FoldChange,
y = -log10(padj),
label = ifelse(genelabels == T, rownames(statsDE),""))
) +
ggtitle("Pink1 knock-out") +
xlab("Log2 fold change") +
ylab("-Log10 adjusted p-value") +
theme(
legend.position = "none",
plot.title = element_text(size = rel(1.5), hjust = 0.5),
axis.title = element_text(size = rel(1.25))
) +
scale_x_continuous(limits=c(-10,10), breaks=seq(-10,10,2))
volcano
